<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{.title}} - Heroprompt</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="{{.css_colors_url}}">
    <link rel="stylesheet" href="{{.css_main_url}}">
    <link rel="stylesheet" href="{{.css_heroprompt_url}}">
    <meta name="color-scheme" content="light dark">
</head>

<body>
    <nav class="navbar navbar-dark bg-dark fixed-top header px-2">
        <div class="d-flex w-100 align-items-center justify-content-between">
            <div class="text-white fw-bold">{{.title}}</div>
            <div class="text-white-50">Heroprompt</div>
        </div>
    </nav>

    <aside class="sidebar">
        <div class="p-2">
            <div class="menu-section">Navigation</div>
            <div class="list-group list-group-flush">
                {{.menu_html}}
            </div>
        </div>
    </aside>

    <main class="main">
        <div class="container-fluid h-100">
            <div class="d-flex align-items-center mb-3">
                <h5 class="mb-0">Heroprompt</h5>
                <div class="ms-auto">
                    <button id="wsCreateBtn" class="btn btn-primary btn-sm me-2">
                        + New Workspace
                    </button>
                    <button id="refreshWs" class="btn btn-outline-secondary btn-sm">
                        ‚Üª Refresh
                    </button>
                </div>
            </div>

            <div class="row h-100">
                <!-- Left Panel: Workspace & File Tree -->
                <div class="col-md-4 h-100">
                    <div class="card h-100">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h6 class="mb-0">Workspace Explorer</h6>
                            <div>
                                <button id="wsDetailsBtn" class="btn btn-sm btn-outline-secondary me-1"
                                    title="Workspace Settings">‚öô</button>
                                <button id="openWsManage" class="btn btn-sm btn-outline-secondary"
                                    title="Manage Workspaces">üìã</button>
                            </div>
                        </div>
                        <div class="card-body p-2">
                            <div class="mb-3">
                                <label for="workspaceSelect" class="form-label small">Current Workspace:</label>
                                <select id="workspaceSelect" class="form-select form-select-sm"></select>
                            </div>

                            <div class="mb-3">
                                <div class="input-group input-group-sm">
                                    <input id="search" class="form-control" placeholder="Search files...">
                                    <button id="doSearch" class="btn btn-outline-secondary">üîç</button>
                                </div>
                            </div>

                            <div id="tree" class="border rounded p-2"
                                style="min-height: 300px; max-height: 400px; overflow-y: auto;">
                                <div class="text-muted small">Select a workspace to browse files</div>
                            </div>

                            <div class="mt-2">
                                <small class="text-muted">Click + buttons to add files/directories to selection</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Right Panel: Tabs for Selection, Prompt, Chat -->
                <div class="col-md-8 h-100">
                    <div class="card h-100">
                        <div class="card-header">
                            <ul class="nav nav-tabs card-header-tabs" id="mainTabs">
                                <li class="nav-item">
                                    <a class="nav-link active tab" data-tab="selection" href="#tab-selection">
                                        Selection (<span id="selCount">0</span>)
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link tab" data-tab="prompt" href="#tab-prompt">Prompt</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link tab" data-tab="chat" href="#tab-chat">Chat</a>
                                </li>
                            </ul>
                        </div>
                        <div class="card-body p-0 h-100">
                            <!-- Selection Tab -->
                            <div id="tab-selection" class="tab-pane active h-100 p-3">
                                <div class="d-flex justify-content-between align-items-center mb-3">
                                    <h6 class="mb-0">Selected Files & Directories</h6>
                                    <span class="badge bg-secondary">~<span id="tokenCount">0</span> tokens</span>
                                </div>
                                <div class="row h-100">
                                    <div class="col-md-6">
                                        <div class="border rounded p-2" style="height: 300px; overflow-y: auto;">
                                            <ul id="selected" class="list-unstyled mb-0">
                                                <li class="text-muted small">No files selected</li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="border rounded p-2" style="height: 300px; overflow-y: auto;">
                                            <div id="preview" class="text-muted small">Select a file to preview</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Prompt Tab -->
                            <div id="tab-prompt" class="tab-pane h-100 p-3" style="display: none;">
                                <div class="h-100 d-flex flex-column">
                                    <div class="mb-3">
                                        <label for="promptText" class="form-label">Instructions:</label>
                                        <textarea id="promptText" class="form-control" rows="8" placeholder="Enter your instructions for what needs to be done with the selected code...

Example:
- Analyze the code structure
- Identify potential improvements  
- Add error handling
- Optimize performance
- Add documentation"></textarea>
                                    </div>
                                    <div class="mb-3">
                                        <button id="copyPrompt" class="btn btn-primary">Copy Generated Prompt</button>
                                    </div>
                                    <div class="flex-grow-1">
                                        <div id="promptOutput" class="border rounded p-2 h-100 overflow-auto">
                                            <div class="text-muted small">Generated prompt will appear here</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Chat Tab -->
                            <div id="tab-chat" class="tab-pane h-100 p-3" style="display: none;">
                                <div class="h-100 d-flex flex-column">
                                    <div class="flex-grow-1 border rounded p-2 mb-3 overflow-auto"
                                        style="height: 300px;">
                                        <div id="chatMessages">
                                            <div class="text-muted small">Chat functionality coming soon...</div>
                                        </div>
                                    </div>
                                    <div class="input-group">
                                        <textarea id="chatInput" class="form-control" rows="2"
                                            placeholder="Type your message..."></textarea>
                                        <button id="sendChat" class="btn btn-primary">Send</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Modals -->
    <div class="modal fade" id="wsCreate" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Create Workspace</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" id="wcClose"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="wcName" class="form-label">Workspace Name (optional)</label>
                        <input type="text" class="form-control" id="wcName" placeholder="Enter workspace name">
                    </div>
                    <div class="mb-3">
                        <label for="wcPath" class="form-label">Base Path (required)</label>
                        <input type="text" class="form-control" id="wcPath" placeholder="Enter base directory path">
                    </div>
                    <div id="wcError" class="text-danger small"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                        id="wcCancel">Cancel</button>
                    <button type="button" class="btn btn-primary" id="wcCreate">Create</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="wsDetails" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Workspace Details</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" id="wdClose"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label for="wdName" class="form-label">Workspace Name</label>
                        <input type="text" class="form-control" id="wdName">
                    </div>
                    <div class="mb-3">
                        <label for="wdPath" class="form-label">Base Path</label>
                        <input type="text" class="form-control" id="wdPath">
                    </div>
                    <div id="wdError" class="text-danger small"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger" id="wdDelete">Delete</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal"
                        id="wdCancel">Cancel</button>
                    <button type="button" class="btn btn-primary" id="wdSave">Save</button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal fade" id="wsManage" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Manage Workspaces</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div id="wmError" class="text-danger small mb-3"></div>
                    <div class="list-group" id="wmList">
                        <div class="text-muted">Loading workspaces...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script src="{{.js_theme_url}}"></script>
    <script src="{{.js_heroprompt_url}}"></script>
</body>

</html>